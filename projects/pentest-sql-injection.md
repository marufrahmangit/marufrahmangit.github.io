---
layout: default
---

[üè† home](../)

<h1 style="text-align: center;">Penetration Testing: SQL Injection</h1>

# Scenario
Appointment is a web-application box focused on SQL Injection attacks. The target is a website with search functionality vulnerable to `SQL Injection`, querying a back-end `SQL database`. 

Different user privileges return varying search results: administrators can access sensitive data (e.g., user info, billing), while regular users or visitors can only view products. However, an attacker can exploit SQL Injection to bypass these restrictions and query any `table` in the database, accessing information they shouldn't be able to see.

**Project Reference**: Hack the Box -> Starting Point -> Tier 1: Appointment

# Enumeration
First, we perform an nmap scan to find the open and available ports and their services. If no alternative flag is specified in the command syntax, nmap will scan the most common 1000 TCP ports for active services. This will suit us in our case.

Additionally, we will need super-user privileges to run the command below with the `-sC` or `-sV` flags. This is because script scanning ( `-sC` ) and version detection ( `-sV` ) are considered more intrusive methods of scanning the target. This results in a higher probability of being caught by a perimeter security device on the target's network.

Only ethernet devices can be used for raw scans on Windows. Use the `--unprivileged` flag for this scan. 

If the host machine "seems" to be down but is really up, but blocking our ping probes we can use the `-Pn` flag.

```kail-terminal
zsh: corrupt history file /home/taskmaster/.zsh_history
‚îå‚îÄ‚îÄ(taskmaster„âøkali)-[~]
‚îî‚îÄ$ sudo nmap -sC -sV -Pn --unprivileged 10.129.9.138
[sudo] password for taskmaster: 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-17 11:54 +06
Nmap scan report for 10.129.9.138
Host is up (0.38s latency).
Not shown: 999 filtered tcp ports (no-response)
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Login

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 55.96 seconds
                                                                                
‚îå‚îÄ‚îÄ(taskmaster„âøkali)-[~]
‚îî‚îÄ$ 


```

The only open port we detect is port `80 TCP`, which is running the `Apache httpd` server version `2.4.38`.

> Knowledge: Apache HTTP Server is a free and open-source application that runs web pages on either physical or virtual web servers. It is one of the most popular HTTP servers, and it usually runs on standard HTTP ports such as 80 TCP, 443 TCP, and alternatively on ports like 8080 TCP or 8000 TCP. HTTP stands for Hypertext Transfer Protocol, an application-layer protocol used for transmitting hypermedia documents like HTML (Hypertext Markup Language). The -sC option in Nmap performs a script scan using the default set of scripts (equivalent to --script=default). Some of these scripts are intrusive and should not be run against a target network without permission. The -sV option enables version detection, which identifies what versions of services are running on specific ports. The Nmap scan provided us with the exact version of the Apache httpd service, which is 2.4.38. It's a good practice to check the service version on vulnerability databases to see if there are any known vulnerabilities. In this case, there are no known vulnerabilities for this version that could be exploited.

In order to further enumerate the service running on port 80, we can navigate directly to the IP address of the target from our browser. By typing the IP address of the target into the URL field of our browser, we are faced with a website containing a log-in form.

![image](https://github.com/user-attachments/assets/d618e229-8a20-4279-8e8f-9f1f7f2fc4b5)

> **Note**: We will be exploring the concept of brute-forcing different directories to include in our Enumeration phase, which will not help us exploit the target and is considered an optional but good-to-know step.

## Brute-Force
Since we are not aware of any specific credentials that we could use to log-in, we will check if there are any other directories or pages useful for us in the enumeration process.

Tried navigating to pages we accustomed to (including possible nested pages):
* http://10.129.9.138/home
* http://10.129.9.138/contact
* http://10.129.9.138/register
* http://10.129.9.138/login
* http://10.129.9.138/login/forgot-password

All of the pages returned the **`Not Found`** error with status code **`404`** indicating that the resource or directory cannot be found.

![image](https://github.com/user-attachments/assets/222843f7-f384-45af-b124-3fb733fde608)

> Instead of manually navigating through the URL search bar to find this hidden data, we will be using a tool that will automate the search for us. This is where tools such as Gobuster come into play. We will be running a tool called `Gobuster`, which will brute-force the directories and files provided in the wordlist of our choice.

### Gobuster
Applying the brute-forcing method to web directories and resources with such a tool will inject the variables from the wordlist one by one, inconsequent requests to the HTTP server, and then read the HTTP response code for each request to see if it is accepted as an existing resource or not. In our case, the wordlists we will be using will contain standard directory and file names (such as `images`, `scripts`, `login.php`, `admin.php`), combined with more uncommon ones.

<pre><font color="#5EBDAB">‚îå‚îÄ‚îÄ(</font><font color="#277FFF"><b>taskmaster„âøkali</b></font><font color="#5EBDAB">)-[</font><b>~</b><font color="#5EBDAB">]</font>
<font color="#5EBDAB">‚îî‚îÄ</font><font color="#277FFF"><b>$</b></font> <font color="#5EBDAB"><u style="text-decoration-style:solid">sudo</u></font> <font color="#49AEE6">apt</font> install gobuster
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
gobuster is already the newest version (3.6.0-1+b1).
The following packages were automatically installed and are no longer required:
  cython3 debtags gcc-12-base gir1.2-ayatanaappindicator3-0.1 gnome-bluetooth
  kali-debtags libappstream4 libarmadillo11 libboost-dev libboost1.74-dev
  libcanberra-gtk-module libcanberra-gtk0 libcbor0.8 libcurl3-nss
  libgcab-1.0-0 libgcc-12-dev libgdal33 libgeos3.12.0 libgumbo1
  libgupnp-igd-1.0-4 libhiredis0.14 libjavascriptcoregtk-4.0-18 libjim0.81
  libmagickcore-6.q16-6 libmagickcore-6.q16-6-extra libmagickwand-6.q16-6
  libmozjs-102-0 libnfs13 libobjc-12-dev libopenblas-dev
  libopenblas-pthread-dev libopenblas0 libperl5.36 libpython3-all-dev
  libpython3.12 libpython3.12-dev librtlsdr0 libsmbios-c2 libstdc++-12-dev
  libtexluajit2 libucl1 libutf8proc2 libxsimd-dev libzxing2 lua-lpeg
  nss-plugin-pem perl-modules-5.36 python3-all-dev python3-backcall
  python3-beniget python3-debian python3-future python3-gast python3-jdcal
  python3-pickleshare python3-pyminifier python3-pythran
  python3-requests-toolbelt python3-rfc3986 python3-unicodecsv python3.12-dev
  xtl-dev
Use &apos;sudo apt autoremove&apos; to remove them.
0 upgraded, 0 newly installed, 0 to remove and 218 not upgraded.
                                                                                
<font color="#5EBDAB">‚îå‚îÄ‚îÄ(</font><font color="#277FFF"><b>taskmaster„âøkali</b></font><font color="#5EBDAB">)-[</font><b>~</b><font color="#5EBDAB">]</font>
<font color="#5EBDAB">‚îî‚îÄ</font><font color="#277FFF"><b>$</b></font> 
</pre>
